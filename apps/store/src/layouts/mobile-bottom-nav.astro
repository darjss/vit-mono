---
import Category from "@/icons/category.astro";
import Home from "@/icons/home.astro";
import Product from "@/icons/product.astro";
import Profile from "@/icons/profile.astro";

// src/components/MobileBottomNav.astro

// Define props the component accepts
interface Props {
  currentPage: string; // e.g., Astro.url.pathname
}

const { currentPage } = Astro.props;

// Define navigation items
const navItems = [
  { href: "/", label: "Нүүр", Icon: Home },
  { href: "/categories", label: "Ангилал", Icon: Category },
  { href: "/products", label: "Бүтээгдэхүүн", Icon: Product },
  { href: "/profile", label: "Профайл", Icon: Profile },
];

// Helper function to check if a link is active
// Handles the base case "/" matching only exactly
const isActive = (itemPath: string, currentPath: string) => {
  if (itemPath === "/") {
    return currentPath === "/";
  }
  // For other paths, check if the current path starts with the item path
  return currentPath.startsWith(itemPath);
};
---

<nav
  class="fixed bottom-0 left-0 right-0 z-50 border-t-4 border-border bg-background shadow-lg md:hidden"
>
  <div class="grid h-full grid-cols-4 font-medium">
    {
      navItems.map((item) => (
        <a
          href={item.href}
          class:list={[
            "group flex flex-col items-center justify-center px-3 py-3 transition-all duration-200 relative overflow-hidden",
            isActive(item.href, currentPage)
              ? "text-primary" // Active color
              : "text-foreground/60 hover:text-primary/80", // Inactive color
          ]}
        >
          {isActive(item.href, currentPage) && (
            <span class="absolute inset-x-0 -bottom-1 h-1 bg-primary rounded-t-md"></span>
          )}
          <div class="relative">
            <item.Icon
              class:list={[
                "h-6 w-6 mb-1 transition-transform duration-200",
                isActive(item.href, currentPage)
                  ? "text-primary scale-110" // Active icon
                  : "text-foreground/60 group-hover:text-primary/80 group-hover:scale-110", // Inactive icon
              ]}
            />
            <span class:list={[
              "absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-primary text-[10px] text-primary-foreground font-bold transition-transform duration-200",
              item.label === "Профайл" && "scale-0", // Only show badge for specific items if needed
            ]}>
            </span>
          </div>
          <span class:list={[
            "text-xs font-semibold transition-all duration-200",
            isActive(item.href, currentPage)
              ? "opacity-100" 
              : "opacity-80 group-hover:opacity-100"
          ]}>
            {item.label}
          </span>
        </a>
      ))
    }
  </div>
</nav>

<style>
  nav {
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
  }
</style>
